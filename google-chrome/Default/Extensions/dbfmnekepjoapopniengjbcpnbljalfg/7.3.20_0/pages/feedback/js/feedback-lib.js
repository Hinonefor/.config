"use strict";var infinity={};function randomString(e){for(var t="",n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",r=0;r<e;r++)t+=n.charAt(Math.floor(Math.random()*n.length));return t}function splitter(e,t){for(var n=[];e.length>t;){var r=e.substring(0,t).lastIndexOf(" ");r=r<=0?t:r,n.push(e.substring(0,r));var i=e.indexOf(" ",r)+1;(i<r||r+t<i)&&(i=r),e=e.substring(i)}return n.push(e),n}infinity.chooseFile=function(e,r){function t(e){var t=this.files[0],n=URL.createObjectURL(t);r&&r({file:t,url:n})}e=e||"image/jpg,image/jpeg,image/png,image/gif,image/bmp,image/webp,image/svg",window.$file=document.createElement("input"),window.$file.setAttribute("type","file"),window.$file.setAttribute("accept",e),window.$file.value="",window.$file.removeEventListener("change",t,!1),window.$file.addEventListener("change",t,!1),window.$file.click()},infinity.getQiniuToken=function(e,t,r){var n="https://infinity-api.infinitynewtab.com/feedbacktoken?filename="+t+"&rt="+Date.now(),i=new XMLHttpRequest;i.open("GET",n,!0),i.timeout=e||0,i.onload=function(e){try{var t=e.target,n=JSON.parse(t.response);if(200!==t.status)throw new Error(n.error);r&&r(n.token)}catch(e){r&&r(null)}},i.ontimeout=function(e){r&&r(null)},i.onerror=function(e){r&&r(null)},i.send()},infinity.uploadToQiniu=function(i,o){var a=randomString(20)+".png";infinity.getQiniuToken(3e3,a,function(e){if(e){var t=new FormData,n="feedback/images/"+a;t.append("key",n),t.append("token",e),t.append("file",i);var r=new XMLHttpRequest;r.open("POST","http://up-z2.qiniup.com",!0),r.timeout=1e4,r.onload=function(e){try{var t=e.target,n=JSON.parse(t.response);if(200!==t.status)throw new Error(n.error);var r="https://best-extension.extfans.com/"+n.key;o&&o(r)}catch(e){o&&o(null)}},r.ontimeout=function(e){o&&o(null)},r.onerror=function(e){o&&o(null)},r.send(t)}else o&&o(null)})};var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,n,r,i,o,a,f,c="",u=0;for(e=Base64._utf8_encode(e);u<e.length;)i=(t=e.charCodeAt(u++))>>2,o=(3&t)<<4|(n=e.charCodeAt(u++))>>4,a=(15&n)<<2|(r=e.charCodeAt(u++))>>6,f=63&r,isNaN(n)?a=f=64:isNaN(r)&&(f=64),c=c+this._keyStr.charAt(i)+this._keyStr.charAt(o)+this._keyStr.charAt(a)+this._keyStr.charAt(f);return c},decode:function(e){var t,n,r,i,o,a,f="",c=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<e.length;)t=this._keyStr.indexOf(e.charAt(c++))<<2|(i=this._keyStr.indexOf(e.charAt(c++)))>>4,n=(15&i)<<4|(o=this._keyStr.indexOf(e.charAt(c++)))>>2,r=(3&o)<<6|(a=this._keyStr.indexOf(e.charAt(c++))),f+=String.fromCharCode(t),64!=o&&(f+=String.fromCharCode(n)),64!=a&&(f+=String.fromCharCode(r));return Base64._utf8_decode(f)},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):(127<r&&r<2048?t+=String.fromCharCode(r>>6|192):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128)),t+=String.fromCharCode(63&r|128))}return t},_utf8_decode:function(e){for(var t="",n=0,r=0,i=0,o=0;n<e.length;)(r=e.charCodeAt(n))<128?(t+=String.fromCharCode(r),n++):191<r&&r<224?(i=e.charCodeAt(n+1),t+=String.fromCharCode((31&r)<<6|63&i),n+=2):(i=e.charCodeAt(n+1),o=e.charCodeAt(n+2),t+=String.fromCharCode((15&r)<<12|(63&i)<<6|63&o),n+=3);return t}},URLSafeBase64_ENC={"+":"-","/":"_","=":"."},URLSafeBase64_DEC={"-":"+",_:"/",".":"="},URLSafeBase64={encode:function(e){return Base64.encode(e).replace(/[+/=]/g,function(e){return URLSafeBase64_ENC[e]})},decode:function(e){return e=e.replace(/[-_.]/g,function(e){return URLSafeBase64_DEC[e]}),Base64.decode(e)}};