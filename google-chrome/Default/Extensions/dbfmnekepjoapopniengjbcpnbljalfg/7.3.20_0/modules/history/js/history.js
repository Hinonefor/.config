"use strict";infinity.modules["history-history"]=function(){return new Vue({el:"#v-history",data:{historys:[],showLoading:!1,showNoMore:!1,lockScroll:!1,maxRes:50,lastItem:{},searchInput:""},created:function(){var t=this;t.initData(),chrome.history.onVisited.addListener(function(){t.initData()}),t.onOpen()},methods:{close:function(){iView.hideSideBar()},onOpen:function(){$(".i-history").on("transitionend",function(t){0<=t.target.className.indexOf("i-history")&&0<=t.target.className.indexOf("i-side-show")&&setTimeout(function(){$("#history-search")[0].focus()},50)})},initData:function(){var o=this;o.showLoading=!1,o.showNoMore=!1,o.lockScroll=!1,document.getElementById("i-side-main-content-history").scrollTop=0,chrome.history.search({text:"",startTime:0,maxResults:o.maxRes},function(t){(o.historys=t).length&&(o.lastItem=t[t.length-1],t.length<o.maxRes&&(o.showLoading=!1,o.showNoMore=!0,o.lockScroll=!0))})},onOpenHistoryItem:function(t,o){o.stopPropagation(),"delete"!=o.target.dataset.id&&infinity.open("isOpenBookmarkInNewTab",t.url,o)},onDeleteHistoryItem:function(o){var i=this;chrome.history.deleteUrl({url:o.url},function(){var t=i.historys.indexOf(o);i.historys.splice(t,1)})},clearAll:function(){var t=this;confirm(infinity.i18n("are_you_sure"))&&chrome.history.deleteAll(function(){t.historys=[]})},searchHistory:function(){var o=this;chrome.history.search({text:o.searchInput,startTime:0},function(t){o.historys=t})},onScrollBottom:function(t){var o=this,i=void 0,e=void 0;o.lockScroll||(e=t.target.clientHeight,i=t.target.scrollHeight,e+t.target.scrollTop===i&&(o.lockScroll=!0,o.showLoading=!0,chrome.history.search({text:"",maxResults:o.maxRes,startTime:0,endTime:o.lastItem.lastVisitTime},function(t){return t.length?(t.length<o.maxRes&&(o.lockScroll=!0),t[t.length-1].lastVisitTime==o.lastItem.lastVisitTime?(o.showNoMore=!0,void(o.showLoading=!1)):void setTimeout(function(){o.historys=o.historys.concat(t),o.lastItem=t[t.length-1],t.length<o.maxRes?(o.showNoMore=!0,o.lockScroll=!0,o.showLoading=!1):(o.showLoading=!1,o.lockScroll=!1)},300)):(o.showNoMore=!0,void(o.showLoading=!1))})))}}})};