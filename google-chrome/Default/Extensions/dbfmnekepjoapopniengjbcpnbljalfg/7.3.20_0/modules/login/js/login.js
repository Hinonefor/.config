"use strict";infinity.modules["login-login"]=function(){return new Vue({el:"#v-login",data:{isShowLoginLoading:!1,inputEmail:"",inputPassword:"",user:null},created:function(){var i=this,n=infinity.get("infinity-user");i.user=n,i.inputEmail=n.email,i.handleMessage()},methods:{init:function(){$(".i-login,.i-box-login").show(),infinity.fadeIn(".i-login-cover","block","0.3s",function(){""==$(".login-email").val()?setTimeout(function(){$(".login-email")[0].focus()},50):setTimeout(function(){$(".login-password")[0].focus()},50)})},handleMessage:function(){var n=this;infinity.onMessage("signUpSuccess",function(){n.closeLoginBox();var i=infinity.get("infinity-user");n.user=i,n.inputEmail=i.email,infinity.alert({html:infinity.i18n("sign_in_success"),autoCloseTime:1.5})}),infinity.onMessage("accountDeleteSuccess",function(){n.closeLoginBox();var i=infinity.get("infinity-user");n.user=i,n.inputEmail=""})},onSubmit:function(i){i.preventDefault();this.isShowLoginLoading=!0,this.onLogin()},closeLoginBox:function(){$(".i-box-login").hide(),infinity.fadeOut(".i-login-cover","","0.3s",function(){$(".i-login").hide()})},onLogin:function(){var n=this,t=n.inputEmail,e=md5(n.inputPassword);$.ajax({url:infinity.api+"/login.php?name="+t+"&password="+e+"&version=2",type:"GET",dataType:"json",timeout:1e4}).done(function(i){"1"==i.message?n.onLoginSuccess(t,e,i.backupTime):n.onUsernameOrPasswordError()}).fail(function(){infinity.alert({html:infinity.i18n("net_error"),autoCloseTime:1.5})})},loginOut:function(){var i=this,n=infinity.get("infinity-user");n.password="",n.isLogin=!1,infinity.set("infinity-user",n),i.user=n,i.inputEmail=n.email,i.inputPassword="";var t=infinity.get("infinity-local-data");t.backupTime=0,infinity.set("infinity-local-data",t),infinity.sendMessage("bg-userStatusChange"),infinity.sendMessage("bg-loginOrLogout")},onUsernameOrPasswordError:function(){infinity.alert({html:infinity.i18n("account_validation_invalid"),autoCloseTime:1.5}),this.isShowLoginLoading=!1},onLoginSuccess:function(i,n,t){var e=this,o=infinity.get("infinity-user");o.email=i,o.password=n;try{o.name=o.email.split("@")[0]}catch(i){o.name="Infinity Undefined"}o.backupTime=t,e.closeLoginBox(),infinity.alert({html:infinity.i18n("sign_in_success"),autoCloseTime:2}),o.isLogin=!0,infinity.set("infinity-user",o),e.user=o,e.isShowLoginLoading=!1,infinity.sendMessage("bg-userStatusChange"),infinity.sendMessage("bg-loginOrLogout")},onLoginFailed:function(){}}})};