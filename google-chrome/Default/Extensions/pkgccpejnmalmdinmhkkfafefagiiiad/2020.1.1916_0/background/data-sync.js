import Awesome from"../dynamic/awesome.js";export default{localDataSyncByGoogle:function(){let e=[];setTimeout(()=>void chrome.storage.sync.get({fhConfigs:null,stickyNotes:null},t=>{e=t.stickyNotes||[];let o=localStorage.length;["fhConfigs","stickyNotes"].forEach(e=>{null!==t[e]&&"object"==typeof t[e]&&o<10&&("stickyNotes"===e?t[e].forEach(e=>{chrome.storage.sync.get(JSON.parse(`{"stickynote${e}":null}`),t=>{null!==t&&localStorage.setItem("stickynote"+e,t["stickynote"+e])})}):Object.keys(t[e]).forEach(o=>{/^DYNAMIC_TOOL/.test(o)?Awesome.install(o.split(":")[1]):localStorage.setItem(o,t[e][o])}),console.log(e," 相关数据均已从服务器同步至本地！"))})}),0),setTimeout(()=>(function(){let t,o={fhConfigs:{},stickyNotes:{}};for(let e=0;e<localStorage.length;e++)t=localStorage.key(e),/^stickynote/.test(t)?o.stickyNotes[t]=void 0:!/[^A-Z_]/.test(t)||/^DYNAMIC_MENU/.test(t)?o.fhConfigs[t]=localStorage.getItem(t):/^DYNAMIC_TOOL/.test(t)&&(o.fhConfigs[t]=1);["fhConfigs","stickyNotes"].forEach(t=>{if(Object.keys(o[t]).length){let s={};"stickyNotes"===t?(e&&e.length&&chrome.storage.sync.remove(e),s[t]=Object.keys(o[t]).map(e=>e.replace(/^stickynote/,"")),JSON.stringify(s).length<=chrome.storage.sync.QUOTA_BYTES_PER_ITEM?chrome.storage.sync.set(s,()=>{Object.keys(o.stickyNotes).forEach(e=>{let t={};t[e]=o.stickyNotes[e],JSON.stringify(t).length<=chrome.storage.sync.QUOTA_BYTES_PER_ITEM?chrome.storage.sync.set(t):console.log("便签笔记 ",e," 数据量太大，无法同步到服务器！")}),console.log(t," 数据同步到服务器成功！")}):console.log(t," 数据量太大，无法同步到服务器！")):(s[t]=o[t],JSON.stringify(s).length<=chrome.storage.sync.QUOTA_BYTES_PER_ITEM?chrome.storage.sync.set(s,()=>console.log(t," 数据同步到服务器成功！")):console.log(t," 数据量太大，无法同步到服务器！"))}})})(),1e4)}};