'use strict';Registry.require(["helper"],()=>{const k=Registry.get("helper"),h={mkCompat:function(a,b,c,d){if(b){if(b.options.compat_wrappedjsobject||d)a=h.unWrappedJsObjectify(a);if(b.options.compat_metadata||d)a=h.unMetaDataify(a);if(b.options.compat_foreach||d)a=h.unEachify(a);if(b.options.compat_arrayleft||d)a=h.unArrayOnLeftSideify(a);b.options.compat_forvarin&&(a=h.fixForVarXStatements(a))}c||(a=a.replace(/(['"]{1,1})use strict(['"]{1,1})/g,"$1use\u00a0strict$2"));return a},findPrototypes:function(a){if(a.includes(".toSource("))return!0;
const b="indexOf lastIndexOf filter forEach every map some slice".split(" ");for(const c in b)if(a.includes("Array."+b[c]+"("))return!0},fixForVarXStatements:function(a){a=a.replace(/for[ \t.]*\([ \t.]*var/gi,"for (var");a=a.split("for (");for(let e=1;e<a.length;e++){var b=a[e];const f=b.indexOf(")");if(-1!=f){var c=b.substr(0,f);if(-1!=c.search(/[ \r\n]*in[ \r\n]/)){var d=c.match(/^[ \r\n]*(?:var[ \r\n\t]*)*(.*?)[ \r\n]* in [ \r\n]*(.*?)$/);null==d||3>d.length||(c=d[1],d=d[2],!c||!d||f>b.length||
b.search(/\)[\n\r\t ]*\{/)!=f||(b="",b+="{     if (!"+d+".hasOwnProperty("+c+")) continue;",a[e]=a[e].replace("{",b)))}}}return a.join("for (")},unArrayOnLeftSideify:function(a){const b=a.split("\n");b.forEach((a,d)=>{const c=a.replace(/[\t ]/g,"");var f=c.search("]=");const g=c.search("]=="),l=c.search("\\[");-1!=l&&""!=c.substr(0,l)&&(f=-1);if(-1!=f&&f!=g){let e="";f=a.search("=");a=a.substr(f+1,a.length-f-1);const g="__narf"+d.toString();e+="var "+g+" = "+a+";\n";k.getStringBetweenTags(c,"[","]=").split(",").forEach((a,
b)=>{""!=a.trim()&&(e+=a+" = "+g+"["+b+"];\n")});b[d]=e}});return b.join("\n")},unEachify:function(a){a=a.replace(/for each[ \t]*\(/gi,"for each(");a=a.split("for each");for(let e=1;e<a.length;e++){var b=a[e];if("("!=b.substr(0,1)){a[e]=" each"+a[e];continue}b=k.getStringBetweenTags(b,"(",")");var c=b.split(" ");let f=null;var d=null;let g=null;for(const a in c)""!=c[a]&&"var"!=c[a]&&(f?d?g||(g=c[a]):d=c[a]:f=c[a]);f&&g?(c="var __kk in "+g,d="",d+="{\n    if (!"+g+".hasOwnProperty(__kk)) continue;",
d+=" \n    var "+f+" = "+g+"[__kk];",a[e]=a[e].replace(b,c).replace("{",d)):a[e]=" each"+a[e]}return a.join("for")},unMetaDataify:function(a){let b=a;for(var c=b.indexOf("<><![CDATA[");-1!=c;){const e=b.substr(0,c),f=e.lastIndexOf("\n");var d="";-1!=f&&(d=e.substr(f,e.length-f));b=b.substr(c,b.length-c);c=d.indexOf("/*");d=d.indexOf("//");-1==c&&-1==d&&(c=d=k.getStringBetweenTags(b,"<><![CDATA[","]]\x3e</>"),c=c.replace(/\\/g,"\\\\"),c=c.replace(/"/g,'\\"').replace(/\n/g,'\\n" + \n"'),c=c.replace(/^\n/g,
"").replace(/\n$/g,""),c=c.replace(/\r/g,""),a=a.replace("<><![CDATA["+d+"]]\x3e</>",'(new CDATA("'+c+'"))'));b=b.substr(1,b.length-1);c=b.indexOf("<><![CDATA[")}return a},unWrappedJsObjectify:function(a){a=a.split("\n");for(let b=0;b<a.length;b++){const c=a[b].search(".wrappedJSObject");if(-1==c)continue;const d=a[b].search("\\/\\/");-1!=d&&d<c||(a[b]=a[b].replace(/\.wrappedJSObject/g,""))}return a.join("\n")}};Registry.register("compat","7c765150",()=>h)});
